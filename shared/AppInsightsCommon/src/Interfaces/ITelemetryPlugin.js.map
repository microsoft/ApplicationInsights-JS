{"version":3,"file":"ITelemetryPlugin.js","sourceRoot":"","sources":["ITelemetryPlugin.ts"],"names":[],"mappings":"AAAA,4DAA4D;AAC5D,kCAAkC;AAClC,YAAY,CAAC","sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\"use strict\";\r\n\r\nimport { IAppInsightsCore } from \"./IAppInsightsCore\";\r\nimport { IConfiguration } from \"./IConfiguration\";\r\nimport { IProcessTelemetryContext, IProcessTelemetryUnloadContext, IProcessTelemetryUpdateContext } from \"./IProcessTelemetryContext\";\r\nimport { ITelemetryItem } from \"./ITelemetryItem\";\r\nimport { ITelemetryPluginChain } from \"./ITelemetryPluginChain\";\r\nimport { ITelemetryUnloadState } from \"./ITelemetryUnloadState\";\r\nimport { ITelemetryUpdateState } from \"./ITelemetryUpdateState\";\r\n\r\nexport interface ITelemetryProcessor {\r\n    /**\r\n     * Call back for telemetry processing before it it is sent\r\n     * @param env - This is the current event being reported\r\n     * @param itemCtx - This is the context for the current request, ITelemetryPlugin instances\r\n     * can optionally use this to access the current core instance or define / pass additional information\r\n     * to later plugins (vs appending items to the telemetry item)\r\n     */\r\n    processTelemetry: (env: ITelemetryItem, itemCtx?: IProcessTelemetryContext) => void;\r\n   \r\n    /**\r\n     * The the plugin should re-evaluate configuration and update any cached configuration settings or\r\n     * plugins. If implemented this method will be called whenever a plugin is added or removed and if\r\n     * the configuration has bee updated.\r\n     * @param updateCtx - This is the context that should be used during updating.\r\n     * @param updateState - The details / state of the update process, it holds details like the current and previous configuration.\r\n     * @returns boolean - true if the plugin has or will call updateCtx.processNext(), this allows the plugin to perform any asynchronous operations.\r\n     */\r\n    update?: (updateCtx: IProcessTelemetryUpdateContext, updateState: ITelemetryUpdateState) => void | boolean;\r\n}\r\n\r\n/**\r\n * Configuration provided to SDK core\r\n */\r\nexport interface ITelemetryPlugin extends ITelemetryProcessor, IPlugin {\r\n    /**\r\n     * Set next extension for telemetry processing, this is now optional as plugins should use the\r\n     * processNext() function of the passed IProcessTelemetryContext instead. It is being kept for\r\n     * now for backward compatibility only.\r\n     * @deprecated - Use processNext() function of the passed IProcessTelemetryContext instead\r\n     */\r\n    setNextPlugin?: (next: ITelemetryPlugin | ITelemetryPluginChain) => void;\r\n\r\n    /**\r\n     * Priority of the extension\r\n     */\r\n    readonly priority: number;\r\n}\r\n\r\nexport interface IPlugin {\r\n    /**\r\n     * Initialize plugin loaded by SDK\r\n     * @param config - The config for the plugin to use\r\n     * @param core - The current App Insights core to use for initializing this plugin instance\r\n     * @param extensions - The complete set of extensions to be used for initializing the plugin\r\n     * @param pluginChain - [Optional] specifies the current plugin chain which identifies the\r\n     * set of plugins and the order they should be executed for the current request.\r\n     */\r\n    initialize: (config: IConfiguration, core: IAppInsightsCore, extensions: IPlugin[], pluginChain?: ITelemetryPluginChain) => void;\r\n    \r\n    /**\r\n     * Returns a value that indicates whether the plugin has already been previously initialized.\r\n     * New plugins should implement this method to avoid being initialized more than once.\r\n     */\r\n    isInitialized?: () => boolean;\r\n\r\n    /**\r\n     * Tear down the plugin and remove any hooked value, the plugin should be removed so that it is no longer initialized and\r\n     * therefore could be re-initialized after being torn down. The plugin should ensure that once this has been called any further\r\n     * processTelemetry calls are ignored and it just calls the processNext() with the provided context.\r\n     * @param unloadCtx - This is the context that should be used during unloading.\r\n     * @param unloadState - The details / state of the unload process, it holds details like whether it should be unloaded synchronously or asynchronously and the reason for the unload.\r\n     * @returns boolean - true if the plugin has or will call processNext(), this for backward compatibility as previously teardown was synchronous and returned nothing.\r\n     */\r\n    teardown?: (unloadCtx: IProcessTelemetryUnloadContext, unloadState?: ITelemetryUnloadState) => void | boolean;\r\n\r\n    /**\r\n     * Extension name\r\n     */\r\n    readonly identifier: string;\r\n\r\n    /**\r\n     * Plugin version (available in data.properties.version in common schema)\r\n     */\r\n    readonly version?: string;\r\n\r\n    /**\r\n     * The App Insights core to use for backward compatibility.\r\n     * Therefore the interface will be able to access the core without needing to cast to \"any\".\r\n     * [optional] any 3rd party plugins which are already implementing this interface don't fail to compile.\r\n     */\r\n    core?: IAppInsightsCore\r\n}\r\n"]}